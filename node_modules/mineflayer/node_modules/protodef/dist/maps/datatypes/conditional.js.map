{"version":3,"sources":["datatypes/conditional.js"],"names":[],"mappings":"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","file":"datatypes/conditional.js","sourcesContent":["var { getField, getFieldInfo, tryDoc, PartialReadError} = require('../utils');\n\nmodule.exports = {\n  'switch': [readSwitch, writeSwitch, sizeOfSwitch],\n  'option': [readOption, writeOption, sizeOfOption]\n};\n\nfunction readSwitch(buffer, offset, {compareTo,fields,compareToValue,...rest}, rootNode) {\n  compareTo = compareToValue!==undefined ? compareToValue : getField(compareTo, rootNode);\n  if (typeof fields[compareTo] === 'undefined' && typeof rest.default === \"undefined\")\n    throw new Error(compareTo + \" has no associated fieldInfo in switch\");\n\n  var caseDefault=typeof fields[compareTo] === 'undefined';\n  var resultingType = caseDefault ? rest.default : fields[compareTo];\n  var fieldInfo = getFieldInfo(resultingType);\n  return tryDoc(() => this.read(buffer, offset, fieldInfo, rootNode),caseDefault ? \"default\" : compareTo);\n}\n\nfunction writeSwitch(value, buffer, offset, {compareTo,fields,compareToValue,...rest}, rootNode) {\n  compareTo = compareToValue!==undefined ? compareToValue : getField(compareTo, rootNode);\n  if (typeof fields[compareTo] === 'undefined' && typeof rest.default === \"undefined\")\n    throw new Error(compareTo + \" has no associated fieldInfo in switch\");\n\n  var caseDefault=typeof fields[compareTo] === 'undefined';\n  var fieldInfo = getFieldInfo(caseDefault ? rest.default : fields[compareTo]);\n  return tryDoc(() => this.write(value, buffer, offset, fieldInfo, rootNode),caseDefault ? \"default\" : compareTo);\n}\n\nfunction sizeOfSwitch(value, {compareTo,fields,compareToValue,...rest}, rootNode) {\n  compareTo = compareToValue!==undefined ? compareToValue : getField(compareTo, rootNode);\n  if (typeof fields[compareTo] === 'undefined' && typeof rest.default === \"undefined\")\n    throw new Error(compareTo + \" has no associated fieldInfo in switch\");\n\n  var caseDefault=typeof fields[compareTo] === 'undefined';\n  var fieldInfo = getFieldInfo(caseDefault ? rest.default : fields[compareTo]);\n  return tryDoc(() => this.sizeOf(value, fieldInfo, rootNode),caseDefault ? \"default\" : compareTo);\n}\n\nfunction readOption(buffer, offset, typeArgs, context) {\n  if(buffer.length<offset+1)\n    throw new PartialReadError();\n  var val = buffer.readUInt8(offset++);\n  if (val !== 0) {\n    var retval = this.read(buffer, offset, typeArgs, context);\n    retval.size++;\n    return retval;\n  }\n  else\n    return {size: 1};\n}\n\nfunction writeOption(value, buffer, offset, typeArgs, context) {\n  if (value != null) {\n    buffer.writeUInt8(1, offset++);\n    offset=this.write(value, buffer, offset, typeArgs, context);\n  }\n  else\n    buffer.writeUInt8(0, offset++);\n  return offset;\n}\n\nfunction sizeOfOption(value, typeArgs, context) {\n  return value == null ? 1 : this.sizeOf(value, typeArgs, context) + 1;\n}\n"],"sourceRoot":"/source/"}